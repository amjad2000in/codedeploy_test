{
 "Resources" :
    {
    "WebServer1":{

      "Type": "AWS::EC2::Instance",
         "Properties":{
         "ImageId" : "ami-00e782930f1c3dbc7",
         "KeyName" : "amjad_crosstalk",
         "InstanceType":"t2.micro",
         "SecurityGroups" : [ { "Ref" : "InstanceSecurityGroup" } ],
         "UserData" : {"Fn::Base64" : {"Fn::Join" : ["", [
           "#!/bin/bash\n",
           "# Launching Instance",
           "sudo su \n",
           "yum update -y \n",
           "yum install httpd -y \n",
           "echo 'This is my Autoscaling test Instance!v5' > /var/www/html/index.html \n",
           "service httpd start \n",
           "chkconfig httpd on \n"
            ] ] } }
        }
    },

    "InstanceSecurityGroup" : {
      "Type" : "AWS::EC2::SecurityGroup",
      "Properties" : {
        "GroupDescription" : "Enable SSH access via port 22, HTTP via Port 80, ICMP via any Port",
        "SecurityGroupIngress" : [ {
          "IpProtocol" : "tcp",
          "FromPort" : "22",
          "ToPort" : "22",
          "CidrIp" : "0.0.0.0/0"
        }, {
          "IpProtocol" : "tcp",
          "FromPort" : "80",
          "ToPort" : "80",
          "CidrIp" : "0.0.0.0/0"
        },{
          "IpProtocol" : "icmp",
          "FromPort" : "8",
          "ToPort" : "0",
          "CidrIp" : "0.0.0.0/0"
        }  ]
      }
   }
 },
 "Outputs" : {
   "WebsiteURL" : {
      "Value" : { "Fn::Join" : ["", ["http://", { "Fn::GetAtt" : [        "WebServer1", "PublicDnsName" ]}]] },
        "Description" : "URL for newly created LAMP stack"
   }
 }

}
